(this["webpackJsonpspotify-tier-list-maker"]=this["webpackJsonpspotify-tier-list-maker"]||[]).push([[0],{87:function(e,t,r){},88:function(e,t,r){"use strict";r.r(t);var a=r(1),s=r(0),n=r.n(s),i=r(16),c=r.n(i),o=r(23),l=r(21),u=r(53),j=r(19),b=r(13),p="SET_ALBUMS",d="ADD_ALBUMS",m="SET_ARTISTS",h="ADD_ARTISTS",O="SET_PLAYLIST",f="ADD_PLAYLIST",x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.albums;switch(t.type){case p:return r;case d:return Object(b.a)(Object(b.a)({},e),{},{next:r.next,items:[].concat(Object(j.a)(e.items),Object(j.a)(r.items))});default:return e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.artists;switch(t.type){case m:return r;case h:return Object(b.a)(Object(b.a)({},e),{},{next:r.next,items:[].concat(Object(j.a)(e.items),Object(j.a)(r.items))});default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.playlists;switch(t.type){case O:return r;case f:return Object(b.a)(Object(b.a)({},e),{},{next:r.next,items:[].concat(Object(j.a)(e.items),Object(j.a)(r.items))});default:return e}},g=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,_=Object(l.e)(Object(l.c)({albums:x,artists:y,playlist:v}),g(Object(l.a)(u.a))),S=r(30),k=r(31),E=r(33),T=r(32),w=r(20),C=r(6),A=r(91),N=r(90),L=function(){return Object(a.jsx)("h1",{className:"main-heading",children:"Spotify Music Search"})},I=Object(o.b)()((function(e){var t=Object({NODE_ENV:"production",PUBLIC_URL:"/spotify-tier-list-maker",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORIZE_URL:"https://accounts.spotify.com/authorize",REACT_APP_CLIENT_ID:"2d6518050da043db89266dc384c2a3c2",REACT_APP_REDIRECT_URL:"https://ryansniu.github.io/spotify-tier-list-maker/redirect"}),r=t.REACT_APP_CLIENT_ID,s=t.REACT_APP_AUTHORIZE_URL,i=t.REACT_APP_REDIRECT_URL,c=e.isValidSession,o=e.location.state,l=o&&o.session_expired;return Object(a.jsx)(n.a.Fragment,{children:c()?Object(a.jsx)(C.a,{to:"/spotify-tier-list-maker/dashboard"}):Object(a.jsxs)("div",{className:"login",children:[Object(a.jsx)(L,{}),l&&Object(a.jsx)(A.a,{variant:"info",children:"Session expired. Please login again."}),Object(a.jsx)(N.a,{variant:"info",type:"submit",onClick:function(){window.location="".concat(s,"?client_id=").concat(r,"&redirect_uri=").concat(i,"&response_type=token&show_dialog=true")},children:"Login to spotify"})]})})})),P=r(10),R=r.n(P),D=r(17),V=r(27),U=r.n(V),F=function(){try{var e=JSON.parse(localStorage.getItem("params"));e&&(U.a.defaults.headers.common.Authorization="Bearer ".concat(e.access_token))}catch(t){console.log("Error setting auth",t)}},B=function(e){Object(E.a)(r,e);var t=Object(T.a)(r);function r(){return Object(S.a)(this,r),t.apply(this,arguments)}return Object(k.a)(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.setExpiryTime,r=e.history,a=e.location;try{if(R.a.isEmpty(a.hash))return r.push("/spotify-tier-list-maker/dashboard");var s=a.hash.slice(1).split("&").reduce((function(e,t){var r=t.split("="),a=Object(D.a)(r,2),s=a[0],n=a[1];return e[s]=n,e}),{}),n=(new Date).getTime()+1e3*s.expires_in;localStorage.setItem("params",JSON.stringify(s)),localStorage.setItem("expiry_time",n),t(n),r.push("/spotify-tier-list-maker/dashboard")}catch(i){r.push("/spotify-tier-list-maker")}}},{key:"render",value:function(){return null}}]),r}(n.a.Component),M=r(8),H=r.n(M),J=r(18),K=function(){var e=Object(J.a)(H.a.mark((function e(t,r){var a;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(),e.next=3,U.a.get(t,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),W=function(e){return{type:p,albums:e}},q=function(e){return{type:m,artists:e}},z=function(e){return{type:O,playlists:e}},G=function(e){return function(){var t=Object(J.a)(H.a.mark((function t(r){var a;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("url",e),t.next=4,K(e);case 4:return a=t.sent,console.log("categoriess",a),t.abrupt("return",r((s=a.albums,{type:d,albums:s})));case 9:t.prev=9,t.t0=t.catch(0),console.log("error",t.t0);case 12:case"end":return t.stop()}var s}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},X=function(e){return function(){var t=Object(J.a)(H.a.mark((function t(r){var a;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("url",e),t.next=4,K(e);case 4:return a=t.sent,console.log("categoriess",a),t.abrupt("return",r((s=a.artists,{type:h,artists:s})));case 9:t.prev=9,t.t0=t.catch(0),console.log("error",t.t0);case 12:case"end":return t.stop()}var s}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},Y=function(e){return function(){var t=Object(J.a)(H.a.mark((function t(r){var a;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("url",e),t.next=4,K(e);case 4:return a=t.sent,console.log("categoriess",a),t.abrupt("return",r((s=a.playlists,{type:f,playlists:s})));case 9:t.prev=9,t.t0=t.catch(0),console.log("error",t.t0);case 12:case"end":return t.stop()}var s}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},Z=r(93),Q=r.p+"static/media/music.b2fe7d4d.jpeg",$=function(e){var t=e.albums;return Object(a.jsx)(n.a.Fragment,{children:Object.keys(t).length>0&&Object(a.jsx)("div",{className:"albums",children:t.items.map((function(e,t){return Object(a.jsx)(n.a.Fragment,{children:Object(a.jsxs)(Z.a,{style:{width:"18rem"},children:[Object(a.jsx)("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link",children:R.a.isEmpty(e.images)?Object(a.jsx)("img",{src:Q,alt:""}):Object(a.jsx)(Z.a.Img,{variant:"top",src:e.images[0].url,alt:""})}),Object(a.jsxs)(Z.a.Body,{children:[Object(a.jsx)(Z.a.Title,{children:e.name}),Object(a.jsx)(Z.a.Text,{children:Object(a.jsx)("small",{children:e.artists.map((function(e){return e.name})).join(", ")})})]})]})},t)}))})})},ee=function(e){var t=e.artists;return Object(a.jsx)(n.a.Fragment,{children:Object.keys(t).length>0&&Object(a.jsx)("div",{className:"artists",children:t.items.map((function(e,t){return Object(a.jsx)(n.a.Fragment,{children:Object(a.jsxs)(Z.a,{style:{width:"18rem"},children:[Object(a.jsx)("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link",children:R.a.isEmpty(e.images)?Object(a.jsx)("img",{src:Q,alt:""}):Object(a.jsx)(Z.a.Img,{variant:"top",src:e.images[0].url,alt:""})}),Object(a.jsx)(Z.a.Body,{children:Object(a.jsx)(Z.a.Title,{children:e.name})})]})},t)}))})})},te=function(e){var t=e.playlist;return Object(a.jsx)("div",{children:Object.keys(t).length>0&&Object(a.jsx)("div",{className:"playlist",children:t.items.map((function(e,t){return Object(a.jsx)(n.a.Fragment,{children:Object(a.jsxs)(Z.a,{style:{width:"18rem"},children:[Object(a.jsx)("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link",children:R.a.isEmpty(e.images)?Object(a.jsx)("img",{src:Q,alt:""}):Object(a.jsx)(Z.a.Img,{variant:"top",src:e.images[0].url,alt:""})}),Object(a.jsxs)(Z.a.Body,{children:[Object(a.jsx)(Z.a.Title,{children:e.name}),Object(a.jsx)(Z.a.Text,{children:Object(a.jsxs)("small",{children:["By ",e.owner.display_name]})})]})]})},t)}))})})},re=function(e){var t=e.isValidSession,r=e.loadMore,s=e.result,i=e.setCategory,c=e.selectedCategory,o=s.albums,l=s.artists,u=s.playlist;return t()?Object(a.jsxs)(n.a.Fragment,{children:[Object(a.jsxs)("div",{className:"search-buttons",children:[!R.a.isEmpty(o.items)&&Object(a.jsx)("button",{className:"".concat("albums"===c?"btn active":"btn"),onClick:function(){return i("albums")},children:"Albums"}),!R.a.isEmpty(l.items)&&Object(a.jsx)("button",{className:"".concat("artists"===c?"btn active":"btn"),onClick:function(){return i("artists")},children:"Artists"}),!R.a.isEmpty(u.items)&&Object(a.jsx)("button",{className:"".concat("playlist"===c?"btn active":"btn"),onClick:function(){return i("playlist")},children:"PlayLists"})]}),Object(a.jsx)("div",{className:"".concat("albums"===c?"":"hide"),children:o&&Object(a.jsx)($,{albums:o})}),Object(a.jsx)("div",{className:"".concat("artists"===c?"":"hide"),children:l&&Object(a.jsx)(ee,{artists:l})}),Object(a.jsx)("div",{className:"".concat("playlist"===c?"":"hide"),children:u&&Object(a.jsx)(te,{playlist:u})}),!R.a.isEmpty(s[c])&&!R.a.isEmpty(s[c].next)&&Object(a.jsx)("div",{className:"load-more",onClick:function(){return r(c)},children:Object(a.jsx)(N.a,{variant:"info",type:"button",children:"Load More"})})]}):Object(a.jsx)(C.a,{to:{pathname:"/spotify-tier-list-maker",state:{session_expired:!0}}})},ae=r(92),se=function(e){var t=Object(s.useState)(""),r=Object(D.a)(t,2),n=r[0],i=r[1],c=Object(s.useState)(""),o=Object(D.a)(c,2),l=o[0],u=o[1];return Object(a.jsx)("div",{children:Object(a.jsxs)(ae.a,{onSubmit:function(t){t.preventDefault(),""!==n.trim()?(u(""),e.handleSearch(n)):u("Please enter a search term.")},children:[l&&Object(a.jsx)("p",{className:"errorMsg",children:l}),Object(a.jsxs)(ae.a.Group,{controlId:"formBasicEmail",children:[Object(a.jsx)(ae.a.Label,{children:"Enter search term"}),Object(a.jsx)(ae.a.Control,{type:"search",name:"searchTerm",value:n,placeholder:"Search for album, artist or playlist",onChange:function(e){var t=e.target.value;i(t)},autoComplete:"off"})]}),Object(a.jsx)(N.a,{variant:"info",type:"submit",children:"Search"})]})})},ne=function(e){var t=Object(s.useState)(document.createElement("div")),r=Object(D.a)(t,1)[0],a=document.querySelector("#loader");return Object(s.useEffect)((function(){a.appendChild(r).classList.add("message")}),[a,r]),Object(s.useEffect)((function(){e.show?(a.classList.remove("hide"),document.body.classList.add("loader-open")):(a.classList.add("hide"),document.body.classList.remove("loader-open"))}),[a,e.show]),c.a.createPortal(e.children,r)},ie=Object(o.b)((function(e){return{albums:e.albums,artists:e.artists,playlist:e.playlist}}))((function(e){var t=Object(s.useState)(!1),r=Object(D.a)(t,2),i=r[0],c=r[1],o=Object(s.useState)("albums"),l=Object(D.a)(o,2),u=l[0],j=l[1],b=e.isValidSession,p=e.history,d=function(){var t=Object(J.a)(H.a.mark((function t(r){var a,s,n,i;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!b()){t.next=18;break}a=e.dispatch,s=e.albums,n=e.artists,i=e.playlist,c(!0),t.t0=r,t.next="albums"===t.t0?6:"artists"===t.t0?9:"playlist"===t.t0?12:15;break;case 6:return t.next=8,a(G(s.next));case 8:return t.abrupt("break",15);case 9:return t.next=11,a(X(n.next));case 11:return t.abrupt("break",15);case 12:return t.next=14,a(Y(i.next));case 14:return t.abrupt("break",15);case 15:c(!1),t.next=19;break;case 18:p.push({pathname:"/spotify-tier-list-maker",state:{session_expired:!0}});case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),m={albums:e.albums,artists:e.artists,playlist:e.playlist};return Object(a.jsx)(n.a.Fragment,{children:b()?Object(a.jsxs)("div",{children:[Object(a.jsx)(L,{}),Object(a.jsx)(se,{handleSearch:function(t){b()?(c(!0),e.dispatch(function(e){return function(){var t=Object(J.a)(H.a.mark((function t(r){var a,s,n,i,c;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a="https://api.spotify.com/v1/search?query=".concat(encodeURIComponent(e),"&type=album,playlist,artist"),t.next=4,K(a);case 4:return s=t.sent,console.log(s),n=s.albums,i=s.artists,c=s.playlists,r(W(n)),r(q(i)),t.abrupt("return",r(z(c)));case 12:t.prev=12,t.t0=t.catch(0),console.log("error",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}(t)).then((function(){c(!1),j("albums")}))):p.push({pathname:"/spotify-tier-list-maker",state:{session_expired:!0}})}}),Object(a.jsx)(ne,{show:i,children:"Loading..."}),Object(a.jsx)(re,{result:m,loadMore:d,setCategory:function(e){j(e)},selectedCategory:u,isValidSession:b})]}):Object(a.jsx)(C.a,{to:{pathname:"/spotify-tier-list-maker",state:{session_expired:!0}}})})})),ce=function(){return Object(a.jsxs)(n.a.Fragment,{children:[Object(a.jsx)(L,{}),"Page not found. Goto ",Object(a.jsx)(w.b,{to:"/spotify-tier-list-maker/dashboard",children:"Home Page"})]})},oe=function(e){Object(E.a)(r,e);var t=Object(T.a)(r);function r(){var e;Object(S.a)(this,r);for(var a=arguments.length,s=new Array(a),n=0;n<a;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))).state={expiryTime:"0"},e.setExpiryTime=function(t){e.setState({expiryTime:t})},e.isValidSession=function(){return(new Date).getTime()<e.state.expiryTime},e}return Object(k.a)(r,[{key:"componentDidMount",value:function(){var e;try{e=JSON.parse(localStorage.getItem("expiry_time"))}catch(t){e="0"}this.setState({expiryTime:e})}},{key:"render",value:function(){var e=this;return Object(a.jsx)(w.a,{children:Object(a.jsx)("div",{className:"main",children:Object(a.jsxs)(C.d,{children:[Object(a.jsx)(C.b,{path:"/spotify-tier-list-maker",exact:!0,render:function(t){return Object(a.jsx)(I,Object(b.a)({isValidSession:e.isValidSession},t))}}),Object(a.jsx)(C.b,{path:"/spotify-tier-list-maker/redirect",render:function(t){return Object(a.jsx)(B,Object(b.a)({isValidSession:e.isValidSession,setExpiryTime:e.setExpiryTime},t))}}),Object(a.jsx)(C.b,{path:"/spotify-tier-list-maker/dashboard",render:function(t){return Object(a.jsx)(ie,Object(b.a)({isValidSession:e.isValidSession},t))}}),Object(a.jsx)(C.b,{component:ce})]})})})}}]),r}(n.a.Component);r(86),r(87);c.a.render(Object(a.jsx)(o.a,{store:_,children:Object(a.jsx)(oe,{})}),document.getElementById("root"))}},[[88,1,2]]]);
//# sourceMappingURL=main.1778f858.chunk.js.map